# 빅데이터 분산

<br>

## 프로젝트 개요

병렬 분산 시스템과 맵리듀스 프레임워크를 이해하고 하둡을 이용하여 빅데이터 분석 문제들에 대해서 맵리듀스 알고리즘을 자바 언어로 구현하고 실행한다.

<br>

## 프로젝트 목표

- 병렬 분산 알고리즘 구현이 가능한 맵리듀스 프레임워크 이해
- 하둡을 이용하여 빅데이터 분석 및 처리용 `맵리듀스 알고리즘`을 구현하는데 필요한 지식과 코딩 능력 배양

<br>


## 병렬분산 알고리즘을 사용하는 이유

- `데이터 중심` 어플리케이션 분야에서는 아주 많은 값싼 서버들을 많이 이용(`scale up`)하는 것을 선호함
- 수십대, 수백대 혹은 수천대의 컴퓨터를 묶어서 처리해야함

<br>

## 맵리듀스 프로그래밍 모델

- 함수형 프로그래밍 언어의 형태
- 유저는 3가지 함수를 구현해서 제공해야 함
    - Main 함수
    - Map 함수: (key1, val1) → [(key2, val2)]
    - Reduce 함수: (key2, [val2]) → [(key3, val3)]
    
<br>

## 맵리듀스 프레임워크

- 컴퓨터들을 모아서 `클러스터`를 만들고 빅데이터를 처리하기 위한 스케일러브(scalable) 병렬 소프트웨어의 구현을 쉽게 할 수 있도록 도와주는 프로그래밍 모델
- 맵리듀스 프레임워크 구현 형태 : 구글의 맵리듀스, 오픈소스 하둡
- 드라이버에 해당하는 메인 함수가 맵(map) 함수와 리듀스(reduce) 함수(맵리듀스 페이즈)를 호출해서 처리
- 각각의 레코드(record) 또는 튜플(tuple)은 (KEY, VALUE) 쌍으로 표현
- `메인 함수`는한 개의 마스터 머신에서 수행하는데 이 머신은 맵 함수를 수행하기 전에 전처리를 하거나 리듀스 함수의 결과를 후처리하는데 사용
- 컴퓨팅은 맵(map)과 리듀스(reduce)라는 유저가 정의한 함수 한 쌍으로 이루어진 `맵리듀스 페이즈(phase)`를 한번 수행하거나 여러번 반복해서 수행
    - 맵리듀스 페이즈는 맵 함수를 먼저 호출하고 리듀스 함수를 호출하는데, 맵 함수가 끝난 후에 `컴바인(combine)함수`를 중간에 수행할 수 있음

<br>

## 맵리듀스 페이즈 (3단계)

- **맵(Map) 페이즈**
    - 제일 먼저 수행되며 데이터의 여러 파티션에 **병렬** 분산으로 호출되어 수행
    - 각 머신마다 수행된 Mapper는 입력 데이터의 한 줄마다 맵(Map) 함수를 호출한다.
    - Map 함수는 (KEY, VALUE)쌍 형태로 결과를 출력하고 여러 머신에 나누어 보내며 **같은 KEY를 가진 (KEY, VALUE) 쌍은 같은 머신으로 보냄**
- **셔플링(Shuffing) 페이즈**
    - 모든 머신에서 맵 페이즈가 다 끝나면 시작
    - 맵 페이즈에서 각각의 머신으로 보내진 (KEY, VALUE) 쌍을 KEY를 이용해서 정렬한 후 각각의 KEY 마다 **같은 KEY를 가진 (KEY, VALUE) 쌍을 모아서 VALUE-LIST**를 만든 다음에 (KEY, VALUE-LIST) 형태로 KEY에 따라서 여러 머신에 분산해서 보냄
- **리듀스(Reduce) 페이즈**
    - 모든 머신에서 셔플링 페이즈가 다 끝나면 각 머신마다 리듀스 페이즈 시작
    - 각각의 머신에서 셔플링 페이즈에서 해당 머신으로 보내진 각각의 (KEY, VALUE-LIST) 쌍 마다 리듀스 함수가 호출되며 하나의 리듀스 함수가 끝나면 다음 (KEY, VALUE-LIST) 쌍에 리듀스 함수가 호출
    - 출력이 있다면 (KEY, VALUE) 쌍 형태로 출력
    
<br>
 
## 맵리듀스의 함수

- **맵 함수**
    - org.apache.hadoop.mapreduce라는 패키지에 있는 **Mapper 클래스를 상속**받아서 맵 메소드를 수정
    - 입력 텍스트 파일에서 라인 단위로 호출되고 입력은 (KEY, VALUE-LIST) 형태
    - KEY는 입력 텍스트 파일에서 맨 앞 문자를 기준으로 맵 함수가 호출된 해당 라인의 첫 번째 문자까지의 offset
    - VALUE는 텍스트의 해당 라인 전체
- **리듀스 함수**
    - org.apache.hadoop.mapreduce라는 패키지에 있는 **Reducer 클래스를 상속**받아서 reduce 메소드 수정
    - 셔플링 페이즈의 출력을 입력으로 받고, (KEY, VALUE-LIST)의 형태
- **컴바인 함수**
    - 각 머신에서 맵 페이즈에서 **맵 함수의 출력 크기를 줄여서** 셔플링 페이즈와 리듀스 페이즈의 비용을 줄여주는데 사용
    - 사용 안해도 됨


<br>

## 하둡

- 주요 구성
    - MapReduce - 소프트웨어의 수행을 분산함
    - HDFS - 데이터를 분산함
- 하둡 분산 파일 시스템(HDFS)
    - 빅데이터 파일을 여러 대의 컴퓨터에 나누어서 저장
    - 각 파일은 여러 개의 순차적인 블록으로 저장
    - 하나의 파일의 각각의 블록은 `fault tolerance`를 위해서 여러 개로 복사되어 여러 머신에 저장됨
- 한 개의 **Name node** (master), 여러 개의 **Data node** (slaves)

<br>

## 실습
### Word Counting 프로그램
Wordcount.java

### 각 단어의 첫 글자만 카운트 하는 프로그램
Wordcount1char.java
